import"./modulepreload-polyfill-B5Qt9EMX.js";const w="data:image/svg+xml,%3csvg%20width='28'%20height='28'%20viewBox='0%200%2028%2028'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='14'%20cy='14'%20r='14'%20fill='%23F2F2F2'/%3e%3cpath%20d='M7%2013.8571L12.6%2019L21%2010'%20stroke='white'%20stroke-width='2'/%3e%3c/svg%3e",I="data:image/svg+xml,%3csvg%20width='28'%20height='28'%20viewBox='0%200%2028%2028'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='14'%20cy='14'%20r='14'%20fill='%2321BF48'/%3e%3cpath%20d='M7%2013.8571L12.6%2019L21%2010'%20stroke='white'%20stroke-width='2'/%3e%3c/svg%3e",y="https://openmarket.weniv.co.kr";document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("signup-form");C(e);const s=document.getElementById("buyer"),t=document.getElementById("seller");s.addEventListener("click",()=>{n("BUYER")}),t.addEventListener("click",()=>{n("SELLER")});const n=o=>{console.log("Signup type:",o),e.dataset.signupType=o,s.classList.toggle("active",o==="BUYER"),t.classList.toggle("active",o==="SELLER");const r=document.querySelector(".seller-input-container");o==="BUYER"?r.style.display="none":r.style.display="flex"},a=document.getElementById("id"),d=document.getElementById("double-check"),l=document.getElementById("id-message");d.addEventListener("click",async o=>{o.preventDefault();const r=await x(a.value);Object.keys(r)[0]==="FAIL_Message"?(l.classList.add("error"),a.classList.add("error"),a.classList.remove("active"),l.textContent=r.FAIL_Message):(l.classList.remove("error"),a.classList.remove("error"),a.classList.add("active"),l.textContent=r.Success)}),a.addEventListener("click",()=>{a.classList.remove("error"),l.classList.remove("error"),l.textContent=""});const c=document.getElementById("password");c.addEventListener("keyup",()=>{$(c.value)?(c.style.backgroundImage=`url(${I})`,e.dataset.validatePassword=!0):(c.style.backgroundImage=`url(${w})`,e.dataset.validatePassword=!1)});const h=document.getElementById("check-password"),m=document.getElementById("password-error-message");h.addEventListener("keyup",()=>{B()?(m.style.display="none",e.dataset.validatePassword=!1):(m.style.display="block",e.dataset.validatePassword=!0)});const p=document.getElementById("phone-1"),g=document.getElementById("phone-2"),f=document.getElementById("phone-3");document.querySelectorAll('input[type="number"]').forEach(o=>{o.addEventListener("input",function(){this.value.length>4&&(this.value=this.value.slice(0,4))})});const v=document.getElementById("name"),u=document.getElementById("registration-number");e.dataset.signupType==="SELLER"&&document.getElementById("certification-check").addEventListener("click",r=>{const i=document.getElementById("signup-form");if(r.preventDefault(),!u.value){alert("사업자 등록번호를 입력해주세요."),i.dataset.validateCertificationNumber=!1;return}if(!b(u.value)){alert("유효한 사업자 등록번호가 아닙니다."),i.dataset.validateCertificationNumber=!1;return}i.dataset.validateCertificationNumber=!0,alert("인증되었습니다.")});const E=document.getElementById("store-name");e.addEventListener("submit",o=>{o.preventDefault();let r={};if(e.dataset.signupType==="BUYER"?r={username:a.value,password:c.value,password2:c.value,phone_number:p.value+g.value+f.value,name:v.value}:r={username:a.value,password:c.value,password2:c.value,phone_number:p.value+g.value+f.value,name:v.value,company_registration_number:u.value,store_name:E.value},!document.getElementById("agree-to-terms").checked){alert("이용약관 및 개인정보처리방침에 동의해주세요.");return}L(r)})});const k=()=>{const s=document.getElementById("signup-form").querySelectorAll("input");for(let t of s)if(t.type!=="checkbox"&&t.value.trim()===""){let n=t;for(;n&&window.getComputedStyle(n).display!=="none";)n=n.parentElement;if(!n){const a=document.querySelector(`label[for="${t.name}"]`);if(a)return a.textContent.trim()}}return null},L=async e=>{const s=document.getElementById("signup-form"),t=k();if(console.log(t),t){alert(`${t}를(을) 입력해주세요.`);return}if(s.dataset.signupType==="SELLER"&&!s.dataset.validateCertificationNumber){alert("사업자 등록번호 인증을 해주세요.");return}if(!s.dataset.validateId){alert("아이디 중복확인을 해주세요.");return}s.dataset.validatePassword||alert("비밀번호를 확인해주세요.");try{const n=await fetch(`${y}/accounts/signup/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(n.ok){const a=await n.json();return console.log(a),alert("회원가입이 완료되었습니다."),window.location.href="./login.html",!0}else{const a=await n.json();console.log(a);const d=Object.keys(a)[0],l=a[d][0];return alert(l),!1}}catch(n){return console.error(n),!1}},B=()=>{const e=document.getElementById("password"),s=document.getElementById("check-password");return e.value===s.value},b=e=>!!/^\d{10}$/.test(e),$=e=>!!/^(?=.*[a-z])(?=.*\d).{8,}$/.test(e),x=async e=>{const s=document.getElementById("signup-form");console.log(e);try{const t=await fetch(`${y}/accounts/signup/valid/username/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e})});if(t.ok){const n=await t.json();return console.log(n),s.dataset.validateId=!0,n}else{const n=await t.json();return console.log(n),s.dataset.validateId=!1,n}}catch(t){return console.error(t),s.dataset.validateId=!1,null}},C=e=>{e.dataset.signupType="BUYER",document.getElementById("buyer").classList.add("active"),e.querySelectorAll("input").forEach(s=>{s.addEventListener("keydown",t=>{t.key==="Enter"&&t.preventDefault()})})};
