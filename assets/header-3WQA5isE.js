import"./modulepreload-polyfill-B5Qt9EMX.js";const r="https://openmarket.weniv.co.kr",l=document.querySelector(".user-navbar .cart button"),t=document.querySelector(".user-navbar .user button"),a=window.location.pathname;l.addEventListener("click",()=>{localStorage.getItem("token")?window.location.href="./cart.html":(alert("로그인 후 이용가능합니다."),window.location.href="./login.html")});a==="/cart.html"&&l.classList.add("active-button");const c=()=>{o.style.display=o.style.display==="flex"?"none":"flex",o.style.display==="flex"?t.classList.add("active-button"):t.classList.remove("active-button"),window.addEventListener("click",e=>{!t.contains(e.target)&&!o.contains(e.target)&&(o.style.display="none")})};localStorage.getItem("token")?t.addEventListener("click",c):(t.removeEventListener("click",c),t.addEventListener("click",()=>{window.location.href="./login.html"}),t.textContent="로그인");const o=document.querySelector(".dropdown-menu"),s=document.querySelector("#logout");s.addEventListener("click",()=>{i()});const i=async()=>{const e=localStorage.getItem("token");if(!e)return console.error("인증된 사용자가 아님. 토큰 없음"),null;try{const n=await fetch(`${r}/accounts/logout/`,{headers:{Authorization:`JWT ${e}`,"Content-Type":"application/json"},method:"POST"});console.log(n),localStorage.removeItem("token"),alert("로그아웃 되었습니다."),window.location.href="./"}catch(n){console.error("로그아웃 실패",n)}};
